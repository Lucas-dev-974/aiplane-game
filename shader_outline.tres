[gd_resource type="ShaderMaterial" load_steps=4 format=3 uid="uid://c3oop7gmpagnm"]

[ext_resource type="Shader" path="res://shader_outline.gdshader" id="2_2q4u3"]

[sub_resource type="Shader" id="Shader_fa2yj"]
code = "shader_type spatial;
render_mode blend_mix ;

uniform sampler2D SCREEN_TEXTURE : hint_screen_texture;
uniform vec4 outline_color : source_color;
uniform float outline_width = 2.0;

void fragment() {
	vec4 pixelatedtext = texture(SCREEN_TEXTURE, SCREEN_UV);
	vec2 pixel_size = 1.0 / VIEWPORT_SIZE;
	ALBEDO = pixelatedtext.rgb;

	for(int y = -1*int(outline_width); y <=1*int(outline_width); y++)
		for(int x = -1*int(outline_width); x <=1*int(outline_width); x++){
			vec4 tex = texture(SCREEN_TEXTURE, SCREEN_UV + vec2(float(x),float(y))*pixel_size);
			if(tex.a == 0.0 &&
			SCREEN_UV.x + float(x) * pixel_size.x < 1.0 &&
			SCREEN_UV.x + float(x) * pixel_size.x > 0.0 &&
			SCREEN_UV.y + float(y) * pixel_size.x < 1.0 &&
			SCREEN_UV.y + float(y) * pixel_size.x > 0.0){
				ALBEDO = outline_color.rgb;
				ALPHA = 1.0;
			}
		}
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_nu1xr"]
render_priority = 1
shader = SubResource("Shader_fa2yj")
shader_parameter/outline_color = Color(0, 0, 0, 1)
shader_parameter/outline_width = 2.01

[resource]
render_priority = 1
next_pass = SubResource("ShaderMaterial_nu1xr")
shader = ExtResource("2_2q4u3")
